#!/bin/bash

in=LakWasMet55_HOW8_2.sorted.sam
out=$0.$in.dat

# dacb:
awk -F'\t' '/^HISEQ/ { tags=$12; if (substr(tags, 1, 2) == "NM") { split(tags, a, ":"); print a[3]; } }' $in > $out
# -F'\t'  # sets field separator to tab
# match lines with /^HISEQ/
# Call the thing in the 12th column "tags"
# If the 12th column begins with "NM" (e.g. NM:i:14) then it is mapped
	# NM i Edit distance to the reference, including ambiguous bases but excluding clipping
# If the 12th column begins with "AS" then it is not. 
	# AS i Alignment score generated by aligner
	# These rows also come with a 13th column that begins with "XS:1:0" which is a BWA flag for 'Suboptimal alignment score'
# split(string, array, fieldsep) # http://www.staff.science.uu.nl/~oostr102/docs/nawk/nawk_92.html
	# This divides string into pieces separated by fieldsep, and stores the pieces in array. The first piece is stored in array[1], the second piece in array[2], and so forth.
